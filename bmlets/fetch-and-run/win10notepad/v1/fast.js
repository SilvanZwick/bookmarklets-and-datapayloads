(function () {if (window.__notepadWin10BookmarkletInstance) {const np = window.__notepadWin10BookmarkletInstance;if (np.window && np.window.style.display === "none") {np.window.style.display = "block";} else if (np.window) {np.window.style.zIndex = "2147483647";np.window.focus();}return;}const instance = {};window.__notepadWin10BookmarkletInstance = instance;const style = document.createElement("style");style.textContent = `.notepad-window, .file-picker {position: fixed;top: 10%;left: 10%;width: 600px;background: white;border: 2px solid #ccc;box-shadow: 0 0 10px rgba(0,0,0,0.5);font-family: 'Segoe UI', sans-serif;z-index: 2147483647;border-radius: 6px;}.title-bar {background: linear-gradient(to right, #0078D7, #005A9E);color: white;padding: 5px 10px;font-weight: bold;display: flex;justify-content: space-between;align-items: center;cursor: move;user-select: none;border-radius: 4px 4px 0 0;}.title-buttons span {margin-left: 10px;cursor: pointer;font-weight: bold;}.menu-bar {background: #f1f1f1;padding: 2px 10px;display: flex;gap: 10px;border-bottom: 1px solid #ccc;}.menu-bar span {cursor: pointer;user-select: none;}.notepad-content {width: 100%;height: 400px;padding: 10px;box-sizing: border-box;border: none;resize: none;outline: none;font-family: Consolas, monospace;}.file-picker {top: 20%;left: 30%;width: 400px;padding: 10px;display: none;}.file-picker input {width: 100%;margin-bottom: 10px;font-size: 16px;}.file-picker-buttons {text-align: right;}.file-picker-buttons button {margin-left: 10px;}`;document.head.appendChild(style);const notepad = document.createElement("div");notepad.className = "notepad-window";notepad.style.zIndex = "2147483647";notepad.innerHTML = `<div class="title-bar"><span>Untitled - Notepad</span><div class="title-buttons"><span id="min">&#x2013;</span><span id="max">&#x25A1;</span><span id="close">&#x2715;</span></div></div><div class="menu-bar"><span id="file-menu">File</span><span id="edit-menu">Edit</span></div><textarea class="notepad-content"></textarea>`;document.body.appendChild(notepad);instance.window = notepad;const filePicker = document.createElement("div");filePicker.className = "file-picker notepad-window";filePicker.style.zIndex = "2147483647";filePicker.innerHTML = `<div class="title-bar"><span>Select File</span><div class="title-buttons"><span id="fp-close">&#x2715;</span></div></div><input type="text" id="filename" placeholder="Enter filename" /><div class="file-picker-buttons"><button id="openBtn">Open</button><button id="saveBtn">Save</button><button id="cancelBtn">Cancel</button></div>`;document.body.appendChild(filePicker);const textarea = notepad.querySelector(".notepad-content");let isSaveMode = false;const showPicker = (saveMode) => {isSaveMode = saveMode;filePicker.style.display = "block";document.getElementById("filename").value = "";document.getElementById("openBtn").style.display = saveMode ? "none" : "inline-block";document.getElementById("saveBtn").style.display = saveMode ? "inline-block" : "none";};const hidePicker = () => filePicker.style.display = "none";document.getElementById("file-menu").onclick = () => {const choice = prompt("Choose File action: open / save / exit");if (choice === "save") showPicker(true);else if (choice === "open") showPicker(false);else if (choice === "exit") cleanup();};document.getElementById("edit-menu").onclick = () => {const action = prompt("Choose Edit action: cut / copy / paste");if (action === "cut") document.execCommand("cut");else if (action === "copy") document.execCommand("copy");else if (action === "paste") document.execCommand("paste");};document.getElementById("saveBtn").onclick = () => {const name = document.getElementById("filename").value;if (!name) return alert("Filename required");localStorage.setItem("TheZwick32.bookmarklets.win10notepad.v1", JSON.stringify({ name, text: textarea.value }));hidePicker();};document.getElementById("openBtn").onclick = () => {const file = localStorage.getItem("TheZwick32.bookmarklets.win10notepad.v1");if (file) {const data = JSON.parse(file);textarea.value = data.text;}hidePicker();};document.getElementById("cancelBtn").onclick = hidePicker;document.getElementById("fp-close").onclick = hidePicker;document.getElementById("min").onclick = () => {notepad.style.display = "none";const keyListener = (e) => {if (e.key === "\\") {notepad.style.display = "block";document.removeEventListener("keydown", keyListener);}};document.addEventListener("keydown", keyListener);};document.getElementById("max").onclick = () => {if (notepad.style.width === "100vw") {notepad.style.width = "600px";notepad.style.height = "auto";notepad.style.top = "10%";notepad.style.left = "10%";} else {notepad.style.width = "100vw";notepad.style.height = "100vh";notepad.style.top = "0";notepad.style.left = "0";}};const cleanup = () => {document.body.removeChild(notepad);document.body.removeChild(filePicker);style.remove();delete window.__notepadWin10BookmarkletInstance;};document.getElementById("close").onclick = cleanup;})();
